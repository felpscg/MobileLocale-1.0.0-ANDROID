sap.ui.define(["sap/suite/ui/generic/template/changeHandler/util/AnnotationChangeUtilsV2","sap/suite/ui/generic/template/changeHandler/util/ChangeHandlerUtils","sap/suite/ui/generic/template/designtime/utils/DesigntimeUtils"],function(A,C,D){"use strict";var a={},b="DataField",c="ConnectedFields",d="Chart",e="RatingIndicator",f="ProgressIndicator",g="Contact",h="DataFieldWithIntentBasedNavigation",i="DataFieldForIntentBasedNavigation",j="DataFieldWithNavigationPath",k="DataFieldForAction",l="DataFieldWithUrl",m="ToolbarButton",L="com.sap.vocabularies.UI.v1.LineItem",n="com.sap.vocabularies.UI.v1.DataPoint",o="com.sap.vocabularies.UI.v1.DataField",p="com.sap.vocabularies.UI.v1.Chart",F="com.sap.vocabularies.UI.v1.FieldGroup",q="com.sap.vocabularies.Communication.v1.Contact",r="com.sap.vocabularies.UI.v1.DataFieldWithUrl",s="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath",t="com.sap.vocabularies.UI.v1.DataFieldForAnnotation",u="com.sap.vocabularies.UI.v1.DataFieldForAction",v="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation",I="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation";a.createNewColumn=function(R,O){var P,w={Label:{},Criticality:{},CriticalityRepresentation:{},IconUrl:{}},x={};x[o]=Object.assign({},w,{Value:{Path:""}});x[r]=Object.assign({},w,{Value:{Path:""},Url:{String:""}});x[s]=Object.assign({},w,{Value:{Path:""},Target:{NavigationPropertyPath:""}});x[t]=Object.assign({},w,{Target:{AnnotationPath:""}});x[u]=Object.assign({},w,{Inline:{Bool:"true"},Determining:{Bool:"false"},Action:{String:""},InvocationGrouping:{}});x[I]=Object.assign({},w,{Action:{String:""},SemanticObject:{String:""},Value:{Path:""}});x[v]=Object.assign({},w,{Inline:{Bool:"true"},Determining:{Bool:"false"},Action:{String:""},SemanticObject:{String:""}});var N={"com.sap.vocabularies.UI.v1.Importance":{"EnumMember":"com.sap.vocabularies.UI.v1.ImportanceType/High"},"RecordType":R};jQuery.extend(true,N,x[R]);for(P in N){if(P!=="RecordType"&&O&&O[P]){jQuery.extend(N[P],O[P]);}if(jQuery.isEmptyObject(N[P])){delete N[P];}}return N;};a.createNewDataPointForColumn=function(w,Q,T){var V="com.sap.vocabularies.UI.v1.VisualizationType/"+Q,R=C.getLineItemRecordForColumn(w);var N={TargetValue:{String:T},Visualization:{EnumMember:V},RecordType:n+"Type",Title:{String:Q}};if(R&&R.Value&&R.Value.Path&&(R.RecordType===o||R.RecordType===I||R.RecordType===r)){N.Value={Path:R.Value.Path};}return N;};a.fixQualifierForNewColumn=function(w,T,B){var x=C.getLineItems(w),y=C.getLineItemRecordIndex(w,x),z=D.fixQualifierForAnnotationPath(x,T,B,y);return z;};a.getColumnTypeValues=function(w){var V={DataField:{displayName:"Data Field"},DataFieldWithUrl:{displayName:"Data Field with URL"},Contact:{displayName:"Contact"},DataFieldForAction:{displayName:"Inline Action"},DataFieldWithIntentBasedNavigation:{displayName:"Navigation Field"},DataFieldWithNavigationPath:{displayName:"Data Field with Nav Path"},DataFieldForIntentBasedNavigation:{displayName:"Navigation Button"},ConnectedFields:{displayName:"Connected Fields"},RatingIndicator:{displayName:"Rating Indicator"},ProgressIndicator:{displayName:"Progress Indicator"},Chart:{displayName:"Chart"}};return V;};a.getColumnType=function(E){var R=C.getLineItemRecordForColumn(E),w;if(!R){return w;}switch(R.RecordType){case u:if(R.Inline&&R.Determining!==true){w=k;}else{w=m;}break;case t:var x=R.Target.AnnotationPath;if(x){if(x.indexOf(n)>=0){var y=C.getEntityTypeFromAnnotationPath(E,x);var Q=x.search("#");var z=x.substring(Q);var B=z?n+z:n;var G=y[B];if(G){if(G.Visualization.EnumMember==="com.sap.vocabularies.UI.v1.VisualizationType/Rating"){w=e;}if(G.Visualization.EnumMember==="com.sap.vocabularies.UI.v1.VisualizationType/Progress"){w=f;}}}else if(R.Target.AnnotationPath.indexOf(q)>=0){w=g;}else if(R.Target.AnnotationPath.indexOf(p)>=0){w=d;}else if(R.Target.AnnotationPath.indexOf(F)>=0){w=c;}}break;case I:w=h;break;case v:if(R.Inline&&R.Determining!==true){w=i;}else{w=m;}break;case o:w=b;break;case r:w=l;break;case s:w=j;break;default:break;}return w;};a.setColumnType=function(w,N,x){x.noRefreshOnChange=true;x.delayRefresh=false;var O=a.getColumnType(w);if(O===N){return;}x.refreshPropertiesPane=true;var y=[],z={},E={},R,B,G={},T=C.getEntityType(C.getComponent(w));switch(N){case b:R=o;break;case l:R=r;break;case k:R=u;break;case h:R=I;break;case i:R=v;break;case j:R=s;break;case c:M=C.getLineItems(w);P=C.getLineItemRecordIndex(w,M);Q=M[P]?M[P]:{};B=a.fixQualifierForNewColumn(w,F,"FE",E);var H=C.createNewFieldGroup(Q);z=A.createCustomAnnotationTermChange(T,H,{},B);y.push(z);R=t;break;case d:B=a.fixQualifierForNewColumn(w,p,"FE",E);var J=D.createNewChart();z=A.createCustomAnnotationTermChange(T,J,{},B);y.push(z);R=t;break;case g:B=a.fixQualifierForNewColumn(w,q,"FE",E);var K=D.createNewContact();z=A.createCustomAnnotationTermChange(T,K,{},B);y.push(z);R=t;break;case e:B=a.fixQualifierForNewColumn(w,n,"FE",E);G=a.createNewDataPointForColumn(w,"Rating","4");z=A.createCustomAnnotationTermChange(T,G,{},B);y.push(z);R=t;break;case f:B=a.fixQualifierForNewColumn(w,n,"FE",E);G=a.createNewDataPointForColumn(w,"Progress","100");z=A.createCustomAnnotationTermChange(T,G,{},B);y.push(z);R=t;break;default:break;}if(!R){return;}var M=C.getLineItems(w);var P=C.getLineItemRecordIndex(w,M);if(P===-1){throw"invalid index for old column";}var Q=M[P];var S=[];S.push.apply(S,M);var U=a.createNewColumn(R,Q);switch(N){case e:case f:case d:case c:U.Target={AnnotationPath:"@"+B};break;case g:U.Target={AnnotationPath:"@"+B};if(!U.Label){U.Label={"String":"New Contact"};}break;default:break;}D._setP13nData(w,U);S.splice(P,1,U);z=A.createCustomAnnotationTermChange(T,S,M,L);y.push(z);return y;};return a;});
