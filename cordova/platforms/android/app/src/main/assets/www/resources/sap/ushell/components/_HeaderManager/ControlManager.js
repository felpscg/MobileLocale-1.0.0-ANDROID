// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/CustomData","sap/ui/core/IconPool","sap/ui/Device","sap/ushell/Config","sap/ushell/EventHub","sap/ushell/resources","sap/ushell/ui/footerbar/ContactSupportButton","sap/ushell/ui/footerbar/EndUserFeedback","sap/ushell/ui/launchpad/AccessibilityCustomData","sap/ushell/ui/shell/ShellHeadItem","sap/ushell/ui/shell/ShellNavigationMenu"],function(C,I,D,a,E,r,b,c,A,S,d){"use strict";var e=[];var f=[];var g={SHELL_NAV_MENU_ONLY:0,ALL_MY_APPS_ONLY:1,SHELL_NAV_MENU:2,ALL_MY_APPS:3};function i(v,H,w){e.push(k(v));e.push(m(H));e.push(q(H,w));e.push(n(w));if(a.last("/core/shell/model/enableNotifications")){e.push(p(w));}if(v.moveEditHomePageActionToShellHeader){e.push(l());}if(v.moveAppFinderActionToShellHeader){e.push(s(v,H));}if(v.moveUserSettingsActionToShellHeader){e.push(j(H));}if(v.moveContactSupportActionToShellHeader){e.push(t());}if(v.moveGiveFeedbackActionToShellHeader){e.push(u());}f.push(E.once("CoreResourcesComplementLoaded").do(function(){_(v,w,H);}));}function h(){e.forEach(function(v){var w=sap.ui.getCore().byId(v);if(w){if(w.destroyContent){w.destroyContent();}w.destroy();}});f.forEach(function(v){v.off();});e=[];f=[];}function _(v,w,x){sap.ui.require(["sap/m/StandardListItem","sap/ushell/ui/shell/NavigationMiniTile"],function(y,N){var M="shellNavigationMenu";var H=function(G,J){var K=J.getProperty("icon")||"sap-icon://circle-task-2",T=J.getProperty("title"),L=J.getProperty("subtitle"),O=T,P=J.getProperty("intent");if(L){O=O+"\n"+L;}var Q=(new y({type:"Active",title:T,description:L,tooltip:O,icon:K,customData:[new C({key:"intent",value:P})],press:[x.handleNavigationMenuItemPress,x]})).addStyleClass("sapUshellNavigationMenuListItems");return Q;};var R=function(G,J){var K=J.getProperty("icon"),T=J.getProperty("title"),L=J.getProperty("subtitle"),O=J.getProperty("intent");return new N({title:T,subtitle:L,icon:K,intent:O,press:function(){var P=this.getIntent();if(P&&P[0]==="#"){x.navigateFromShellApplicationNavigationMenu(P);}}});};var z=new d(M,{title:"{/application/title}",icon:"{/application/icon}",showTitle:{path:"/application/showNavMenuTitle"},showRelatedApps:v.appState!=="lean",items:{path:"/application/hierarchy",factory:H.bind(this)},miniTiles:{path:"/application/relatedApps",factory:R.bind(this)},visible:{path:"/ShellAppTitleState",formatter:function(G){return G===g.SHELL_NAV_MENU;}}});var B=sap.ui.getCore().byId("shell-header");z.setModel(B.getModel());var F=sap.ui.getCore().byId("shellAppTitle");if(F){F.setNavigationMenu(z);}e.push(M);return M;}.bind(this));}function j(v){var U=new S({id:"userSettingsBtn",icon:"sap-icon://action-settings",tooltip:r.i18n.getText("userSettings"),text:r.i18n.getText("userSettings"),press:v.handleUserSettingsPress});return U.getId();}function k(v){var H=new S({id:"homeBtn",tooltip:r.i18n.getText("homeBtn_tooltip"),ariaLabel:r.i18n.getText("homeBtn_tooltip"),icon:I.getIconURI("home"),target:v.rootIntent?"#"+v.rootIntent:"#"});if(a.last("/core/extension/enableHelp")){H.addStyleClass("help-id-homeBtn",true);}H.addCustomData(new A({key:"aria-disabled",value:"false",writeToDom:true}));if(D.system.desktop){H.addEventDelegate({onsapskipback:function(w){if(sap.ushell.renderers.fiori2.AccessKeysHandler.getAppKeysHandler()){w.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;}},onsapskipforward:function(w){if(sap.ushell.renderers.fiori2.AccessKeysHandler.getAppKeysHandler()){w.preventDefault();sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;}}});}return H.getId();}function l(){var T=new S({id:"ActionModeBtn",icon:"sap-icon://edit"});if(a.last("/core/extension/enableHelp")){T.addStyleClass("help-id-ActionModeBtn");}return T.getId();}function m(v){var B=sap.ui.getCore().getConfiguration().getRTL()?"feeder-arrow":"nav-back";var w=new S({id:"backBtn",tooltip:r.i18n.getText("backBtn_tooltip"),ariaLabel:r.i18n.getText("backBtn_tooltip"),icon:I.getIconURI(B),press:v.pressNavBackButton.bind(v)});return w.getId();}function n(v){var w="meAreaHeaderButton";var M=new S({id:w,icon:"{/userImage/personPlaceHolder}",ariaLabel:r.i18n.getText("MeAreaToggleButtonAria"),tooltip:sap.ushell.Container.getUser().getFullName(),press:function(){E.emit("showMeArea",Date.now());}});if(D.system.desktop){M.addEventDelegate({onsapskipforward:function(x){sap.ushell.renderers.fiori2.AccessKeysHandler.bForwardNavigation=true;x.preventDefault();window.document.getElementById("sapUshellHeaderAccessibilityHelper").focus();}});}M.setModel(v);return w;}function o(B){B.applySettings({floatingNumber:{parts:["/notificationsCount"],formatter:function(v){var w=this.getDomRef(),x="";if(w){if(v>0){x=r.i18n.getText("NotificationToggleButtonCollapsed",v);}else{x=r.i18n.getText("NotificationToggleButtonCollapsedNoNotifications");}w.setAttribute("aria-label",x);}return v;}}},true,true);}function p(v){var w="NotificationsCountButton";var x="bell";var N=new S({id:w,icon:I.getIconURI(x),text:r.i18n.getText("notificationsBtn_title"),enabled:false,press:function(){E.emit("showNotifications",Date.now());}});N.setModel(v);N.setModel(r.i18nModel,"i18n");o(N);return w;}function q(v,w){var x=new S({id:"endItemsOverflowBtn",tooltip:r.i18n.getText("shellHeaderOverflowBtn_tooltip"),ariaLabel:r.i18n.getText("shellHeaderOverflowBtn_tooltip"),icon:"sap-icon://overflow",press:[v.pressEndItemsOverflow,v]});o(x);x.setModel(w);return x.getId();}function s(v,w){var O=new S({id:"openCatalogBtn",text:r.i18n.getText("open_appFinderBtn"),tooltip:r.i18n.getText("open_appFinderBtn"),icon:"sap-icon://sys-find",visible:!v.disableAppFinder,press:w.handleAppFinderPress});if(a.last("/core/extension/enableHelp")){O.addStyleClass("help-id-openCatalogActionItem");}return O.getId();}function t(){var B="ContactSupportBtn",v=sap.ui.getCore().byId(B);if(!v){var T=new b("tempContactSupportBtn",{visible:true});var w=T.getIcon();var x=T.getText();v=new S({id:B,icon:w,tooltip:x,text:x,press:function(){T.firePress();}});}return B;}function u(){var B="EndUserFeedbackBtn",F=sap.ui.getCore().byId(B);if(!F){var T=new c("EndUserFeedbackHandlerBtn",{});var v=T.getIcon();var w=T.getText();F=new S({id:B,icon:v,tooltip:w,addAriaHiddenFalse:true,ariaLabel:w,text:w,visible:false});}return F.getId();}return{init:i,destroy:h,_createOverflowButton:q};});
