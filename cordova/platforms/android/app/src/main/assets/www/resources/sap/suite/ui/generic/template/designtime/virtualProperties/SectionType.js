sap.ui.define(["sap/suite/ui/generic/template/changeHandler/util/ChangeHandlerUtils","sap/suite/ui/generic/template/changeHandler/util/AnnotationChangeUtilsV2","sap/suite/ui/generic/template/designtime/utils/DesigntimeUtils"],function(U,A,D){"use strict";var S={};var F="com.sap.vocabularies.UI.v1.FieldGroup";var a="com.sap.vocabularies.UI.v1.Facets";var L="com.sap.vocabularies.UI.v1.LineItem";var C="com.sap.vocabularies.UI.v1.Chart";var b="com.sap.vocabularies.UI.v1.CollectionFacet";var R="com.sap.vocabularies.UI.v1.ReferenceFacet";var I="com.sap.vocabularies.UI.v1.Identification";var c="com.sap.vocabularies.UI.v1.DataField";var d="com.sap.vocabularies.UI.v1.FieldGroupType";var e="com.sap.vocabularies.Communication.v1.Contact";var f="com.sap.vocabularies.Communication.v1.Address";var g="SmartForm";var h="SmartTable";var j="SmartChart";var k="Contact";var l="Address";S.createNewSection=function(o,s){var n,N={"Label":{"String":"New Group"},"ID":{},"Target":{},"RecordType":R};if(s){N.Target.AnnotationPath="@"+s;n={"ID":{},"Label":{},"Facets":[N],"RecordType":b};}var i=s?n:N;for(var p in o){if(p!=="RecordType"&&p!=="Target"&&p!=="Facets"&&i[p]){jQuery.extend(i[p],o[p]);}if(jQuery.isEmptyObject(i[p])){delete i[p];}}return i;};S.getSectionTypeValues=function(){var v={SmartForm:{displayName:"Smart Form"},SmartTable:{displayName:"Smart Table"},SmartChart:{displayName:"Smart Chart"},Contact:{displayName:"Contact"},Address:{displayName:"Address"}};return v;};S.getSectionType=function(s){var i,o;var E=U.getODataEntityType(U.getComponent(s));var m=E[a];var n=s.getId();n=n.split("--")[1];if(n){n=n.substring(0,n.lastIndexOf("::"));var p=D.getFacetIndexFromID(n,m);if(p===undefined){return;}o=m[p];if(o.RecordType===b){var N=o.Facets;var q,t,r;for(i=0;i<N.length;i++){if(N[i].RecordType===b){return;}if(N[i].Target.AnnotationPath.indexOf(F)>-1||N[i].Target.AnnotationPath.indexOf(I)>-1){q=true;}else if(N[i].Target.AnnotationPath.indexOf(L)>-1){t=true;}}if(q&&t){r="invalid";}else{r=q?g:h;}return r;}else{if(o.Target&&(o.Target.AnnotationPath.indexOf(F)>-1||o.Target.AnnotationPath.indexOf(I)>-1)){return g;}if(o.Target&&o.Target.AnnotationPath.indexOf(L)>-1){return h;}if(o.Target&&o.Target.AnnotationPath.indexOf(C)>-1){return j;}if(o.Target&&o.Target.AnnotationPath.indexOf(e)>-1){return k;}if(o.Target&&o.Target.AnnotationPath.indexOf(f)>-1){return l;}}}};S.setSectionType=function(s,v,o){var i,r,O=S.getSectionType(s);o.noRefreshOnChange=true;o.delayRefresh=false;if(O===v){return;}o.refreshPropertiesPane=true;switch(v){case g:r=F;break;case h:r=L;break;case j:r=C;break;case k:r=e;break;case l:r=f;break;default:break;}if(!r){return;}var E=U.getODataEntityType(U.getComponent(s));var m=E[a];m.splice();var n=s.getId().split("--")[1];n=n.substring(0,n.lastIndexOf("::"));i=D.getFacetIndexFromID(n,m);if(i===undefined){return;}var p=m[i];var N=[],q=[],t={},u;var T=U.getEntityType(U.getComponent(s));N.push.apply(N,m);if(v===g){u=U.createFieldGroupTerm(E);t[u]={"Data":[{"RecordType":c}],"RecordType":d};}var w=S.createNewSection(p,u);if(v===g&&!(w.ID&&w.ID.String)){w.ID={"String":v+i};}N.splice(i,1,w);var x=A.createCustomAnnotationTermChange(T,N,m,a);var y=A.createCustomAnnotationTermChange(T,t[u],{},u);q.push(x);q.push(y);return q;};return S;});
