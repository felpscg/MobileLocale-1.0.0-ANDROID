/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2017 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/ui/core/XMLTemplateProcessor","sap/ui/core/util/XMLPreprocessor","sap/ui/core/Fragment","sap/ui/model/json/JSONModel"],function(X,a,F,J){"use strict";var N="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1",b="sap.ui.mdc",C={NAME:"CreationRow",FRAGMENTNAME:"sap.fe.macros.table.CreationRow"},T="ResponsiveTableType",c="GridTableType",r=sap.ui.getCore().getLibraryResourceBundle("sap.fe.macros.designtime");var t=function(o,d,p){var e=new J(p);return Promise.resolve(a.process(o,{},{bindingContexts:{"this":e.createBindingContext("/")},models:{"this":e}})).then(function(o){var g=o.getElementsByTagNameNS("sap.ui.mdc","CreationRow")[0];g.setAttribute("visible",p.visible);return(d.getId&&F.load({definition:o}))||g;});};var f=function(s,o,p){var d=X.loadTemplate(s,"fragment");return t(d,o,p);};return{"changeCreationMode":{"changeHandler":{applyChange:function(o,d,p){var m=o.getContent(),M=p.modifier,s=o.getSelector(),e=M.bySelector(s,p.appComponent,p.view),v=p.viewId||p.view.getId(),g,h,S,O,i,n;if(M.targets==="xmlTree"){g=e.getAttributeNS(N,"creationMode");h=e.getAttributeNS(N,"createAtEnd");S=e.getAttributeNS(N,"showCreate");O=e.getAttributeNS(N,"onCreate");n=e.getAttributeNS(N,"namedBindingId");}else{g=e.data("creationMode");h=e.data("createAtEnd");S=e.data("showCreate");O=e.data("onCreate");n=e.data("namedBindingId");}if(g!==m.creationMode){o.setRevertData({creationMode:g,createAtEnd:h});if(M.targets==="xmlTree"){e.setAttributeNS(N,"creationMode",m.creationMode);e.setAttributeNS(N,"createAtEnd",m.createAtEnd);}else{e.data("creationMode",m.creationMode);e.data("createAtEnd",m.createAtEnd);}if(m.creationMode===C.NAME){f(C.FRAGMENTNAME,e,{visible:S,onCreate:O,createAtEnd:m.createAtEnd,namedBindingId:n,metaModel:p.appComponent.getModel().getMetaModel(),modifier:M,viewId:v}).then(function(j){i=M.getAggregation(e,"actions").filter(function(k){return M.getId(k)&&M.getId(k).indexOf("::Create")>-1;})[0];M.setVisible(i,false);M.insertAggregation(e,"creationRow",j,0,p.view);});}else if(g===C.NAME){i=M.getAggregation(e,"actions").filter(function(j){return M.getId(j)&&M.getId(j).indexOf("::Create")>-1;})[0];M.setPropertyBinding(i,"visible",S);M.getAggregation(e,"creationRow").destroy();}}},revertChange:function(o,d,p){var m=p.modifier,e=o.getRevertData(),s=o.getSelector(),g=m.bySelector(s,p.appComponent,p.view),v=p.viewId||p.view.getId(),S,O,h;if(m.targets==="xmlTree"){g.setAttributeNS(N,"creationMode",e.creationMode);g.setAttributeNS(N,"createAtEnd",e.createAtEnd);S=g.getAttributeNS(N,"showCreate");O=g.getAttributeNS(N,"onCreate");}else{g.data("creationMode",e.creationMode);S=g.data("showCreate");O=g.data("onCreate");}if(e.creationMode==="CreationRow"){h=m.getAggregation(g,"actions").filter(function(i){return m.getId(i)&&m.getId(i).indexOf("::Create")>-1;})[0];m.setVisible(h,false);f(C.FRAGMENTNAME,g,{visible:S,onCreate:O,createAtEnd:e.createAtEnd,metaModel:p.appComponent.getModel().getMetaModel(),modifier:m,viewId:v}).then(function(i){m.insertAggregation(g,"creationRow",i,0,p.view);});}},completeChangeContent:function(o,m,p){}},"layers":{"CUSTOMER_BASE":false,"CUSTOMER":false}},"changeTableType":{"changeHandler":{applyChange:function(o,d,p){var m=o.getContent(),M=p.modifier,s=o.getSelector(),S=M.bySelector(s,p.appComponent,p.view),e,g,n;if(M.targets==="xmlTree"){if(m.previousTableType!==m.tableType){o.setRevertData({tableType:m.previousTableType});e=S.getElementsByTagNameNS(b,"type")[0];g=e.getElementsByTagNameNS(b,m.tableType===T?c:T)[0];e.removeChild(g);n=document.createElementNS(b,m.tableType);if(m.tableType===c){n.setAttribute("rowCountMode","Auto");n.setAttribute("rowCount",3);}e.appendChild(n);}}},revertChange:function(o,d,p){var m=p.modifier,R=o.getRevertData(),s=o.getSelector(),S=m.bySelector(s,p.appComponent,p.view),e,P,g;if(m.targets==="xmlTree"){e=S.getElementsByTagNameNS(b,"type")[0];P=e.getElementsByTagNameNS(b,R.tableType===T?c:T)[0];e.removeChild(P);g=document.createElementNS(b,R.tableType);if(R.tableType===c){g.setAttribute("rowCountMode","Auto");g.setAttribute("rowCount",3);}e.appendChild(g);}},completeChangeContent:function(o,m,p){}},"layers":{"CUSTOMER_BASE":false,"CUSTOMER":false}},"changeActionText":{"changeHandler":{applyChange:function(o,d,p){var m=o.getContent(),M=p.modifier,B;o.setRevertData({isTextCreateDelete:m.isTextCreateDelete});M.getAggregation(d,"actions").forEach(function(A){B=M.targets==="xmlTree"?A.getAttribute("id"):A.getId();if(B.indexOf("::Create")>-1){M.setProperty(A,"text",m.isTextCreateDelete?r.getText("TABLE_ACTIONBUTTON_TEXT_ADD"):r.getText("TABLE_ACTIONBUTTON_TEXT_CREATE"));}if(B.indexOf("::Delete")>-1){M.setProperty(A,"text",m.isTextCreateDelete?r.getText("TABLE_ACTIONBUTTON_TEXT_REMOVE"):r.getText("TABLE_ACTIONBUTTON_TEXT_DELETE"));}});},revertChange:function(o,d,p){var R=o.getRevertData(),m=p.modifier,B;m.getAggregation(d,"actions").forEach(function(A){B=m.targets==="xmlTree"?A.getAttribute("id"):A.getId();if(B.indexOf("::Create")>-1){m.setProperty(A,"text",R.isTextCreateDelete?r.getText("TABLE_ACTIONBUTTON_TEXT_CREATE"):r.getText("TABLE_ACTIONBUTTON_TEXT_ADD"));}if(B.indexOf("::Delete")>-1){m.setProperty(A,"text",R.isTextCreateDelete?r.getText("TABLE_ACTIONBUTTON_TEXT_DELETE"):r.getText("TABLE_ACTIONBUTTON_TEXT_REMOVE"));}});},completeChangeContent:function(o,m,p){}},"layers":{"CUSTOMER_BASE":false,"CUSTOMER":false}}};});
