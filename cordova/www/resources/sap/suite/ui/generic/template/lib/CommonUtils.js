sap.ui.define(["sap/ui/base/Object","sap/ui/base/Event","sap/ui/core/mvc/ControllerExtension","sap/ui/model/Context","sap/ui/model/Filter","sap/m/Table","sap/m/ListBase","sap/m/MessageBox","sap/ui/generic/app/navigation/service/NavigationHandler","sap/ui/generic/app/navigation/service/NavError","sap/suite/ui/generic/template/lib/testableHelper","sap/base/Log","sap/ui/model/analytics/odata4analytics"],function(B,E,C,a,F,R,L,M,N,b,t,c,o){"use strict";var d=sap.ui.getCore();function f(e,P){var i=sap.ui.require(P);return typeof i==="function"&&(e instanceof i);}function g(e){return f(e,"sap/ui/comp/smarttable/SmartTable");}function h(e){return f(e,"sap/ui/comp/smartchart/SmartChart");}function l(e){return f(e,"sap/ui/table/Table");}function m(e){return f(e,"sap/ui/table/AnalyticalTable");}function n(e){return f(e,"sap/ui/table/TreeTable");}function p(e){return f(e,"sap/m/Table");}function q(e){if(h(e)||g(e)){return e.getEntitySet();}else if(g(e.getParent())){return e.getParent().getEntitySet();}}function r(e){var T=e&&sap.ui.getCore().byId(e);if(T){T.focus();}}var g=t.testableStatic(g,"CommonUtils_isSmartTable");function s(u,S,v){var w;var x=Object.create(null);var O=Object.create(null);function P(e){var i;if(g(e)){i=e.getCustomToolbar();}else if(h(e)){i=e.getToolbar();}if(i){var j=X(i);if(j&&j.annotatedActionIds){O[e.getId()]=JSON.parse(atob(j.annotatedActionIds));}if(j&&j.deleteButtonId){O[e.getId()].push({ID:j.deleteButtonId,RecordType:"CRUDActionDelete"});}}}function G(e){if(!O[e.getId()]){P(e);}return O[e.getId()];}function y(e){var i,j,k,P1;i=e.getEntitySet();j=u.getOwnerComponent().getModel().getMetaModel();k=j.getODataEntitySet(i);P1=j.getODataEntityType(k.entityType);return P1;}function z(e,i,j){var k=e instanceof E?e.getSource():e;var P1=k.getId();var Q1=x[P1];if(!Q1){if(j){return null;}Q1={control:k,infoObject:Object.create(null),categories:[]};(i||jQuery.noop)(Q1.infoObject,Q1.categories,k);x[P1]=Q1;}return Q1.infoObject;}function A(e,i){for(var j in x){var k=x[j];if(k.categories.indexOf(e)>=0){i(k.infoObject,k.control);}}}function D(e){S.oApplication.attachControlToParent(e,u.getView());}function H(e){if(e.getVisible&&!e.getVisible()){return null;}return e.getParent()||e.oContainer;}function I(e){var i=u.getView();var j=false;for(var k=i.getVisible()&&d.byId(e);k&&!j;k=H(k)){j=k===i;}return j;}function J(e){for(var i=0;i<e.length;i++){var j=e[i];if(I(j)){return j;}}return"";}function K(e,i,j,k){return S.oApplication.getDialogFragmentForView(u.getView(),e,i,j,k);}var Q;function T(){var e=u.getOwnerComponent();Q=Q||e.getModel("i18n").getResourceBundle();return Q.getText.apply(Q,arguments);}function U(k,e,i,j){var P1,Q1,R1,S1;var T1=u.getOwnerComponent();var U1=e.indexOf("::"+T1.getEntitySet()+"--")+2;P1=e.substring(U1,e.lastIndexOf("::"));P1=P1.replace(/--/g,"|").replace(/::/g,"|");Q1=k+"|"+P1;R1=i||k;S1=T(Q1,j);if(S1===Q1){S1=T(R1,j);}return S1;}function V(e,i){var i=i||e.getSelectionBehavior();if(i==="DATAPOINT"){return{"dataPoints":e.getSelectedDataPoints().dataPoints,"count":e.getSelectedDataPoints().count};}else if(i==="CATEGORY"){return{"dataPoints":e.getSelectedCategories().categories,"count":e.getSelectedCategories().count};}else if(i==="SERIES"){return{"dataPoints":e.getSelectedSeries().series,"count":e.getSelectedSeries().count};}}function W(e,j,k){var P1=[];if(g(e)){e=e.getTable();}else if(h(e)){e.getChartAsync().then(function(S1){e=S1;if(e&&e.getMetadata().getName()==="sap.chart.Chart"){var T1=false;j=j||e.getSelectionBehavior();k=k||V(e,j);if(k&&k.count>0){if(j==="DATAPOINT"){T1=true;}var U1=k.dataPoints;var V1=[];for(var i=0;i<U1.length;i++){if(T1){if(U1[i].context){P1.push(U1[i].context);}}else{V1.push(U1[i].dimensions);}}if(!T1){P1[0]=V1;}}}});}if(e instanceof L){P1=e.getSelectedContexts();}else if(l(e)){var Q1=e.getPlugins().filter(function(S1){return S1.isA("sap.ui.table.plugins.SelectionPlugin");})[0];var R1=Q1?Q1.getSelectedIndices():e.getSelectedIndices();if(R1){for(var i=0;i<R1.length;i++){P1.push(e.getContextByIndex(R1[i]));}}}return P1;}function X(e){var i={};if(e instanceof sap.ui.core.Element){e.getCustomData().forEach(function(j){i[j.getKey()]=j.getValue();});}return i;}function Y(e){var j,k,P1;var Q1=i1(e);if(!g(Q1)&&!h(Q1)){Q1=Q1.getParent();}var R1=W(Q1);var S1=Q1.getModel();k=f1(Q1);d1(k,R1,S1,Q1);j=G(Q1);for(var i=0;i<j.length;i++){P1=j[i];Z(P1,S1,R1,Q1);}}function Z(e,i,j,k){var P1;if(e.RecordType==="CRUDActionDelete"){P1=b1(i,j,k);k.getModel("_templPriv").setProperty("/listReport/deleteEnabled",P1);}else if(e.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||e.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){var Q1=i.getMetaModel();P1=a1(i,Q1,j,e.RecordType,e.Action,k);}var R1=u.getView().byId(e.ID);if(R1&&/generic\/controlProperties/.test(R1.getBindingPath("enabled"))&&P1!==undefined){_(e.ID,"enabled",P1);}}function $(e){var i;var j=i1(e);var k=W(j);var P1=e.getModel();i=g1();d1(i,k,P1,j);}function _(i,e,j){var k=u.getView().getModel("_templPriv");var P1=k.getProperty("/generic/controlProperties/"+i);if(!P1){P1={};P1[e]=j;k.setProperty("/generic/controlProperties/"+i,P1);}else{k.setProperty("/generic/controlProperties/"+i+"/"+e,j);}}function a1(e,i,k,P1,Q1,R1){var S1,T1,U1,V1;var W1=false;if(P1==="com.sap.vocabularies.UI.v1.DataFieldForAction"){S1=i.getODataFunctionImport(Q1);U1=S1&&S1["sap:action-for"];if(U1&&U1!==""&&U1!==" "){if(k.length>0){V1=S1["sap:applicable-path"];if(V1&&V1!==""&&V1!==" "){for(var j=0;j<k.length;j++){if(!k[j]){continue;}T1=e.getObject(k[j].getPath());if(T1&&T1[V1]){W1=true;break;}}}else{W1=true;}}}else{W1=true;}}else if(P1==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){if(k.length>0||(h(R1)&&R1.getDrillStackFilters().length>0)){W1=true;}}return W1;}function b1(e,i,j){if(i.length===0){return false;}var k=c1(j);var P1=k&&k.Deletable&&k.Deletable.Path;return i.some(function(Q1){var R1=e.getObject(Q1.getPath()+"/DraftAdministrativeData");var S1=!(R1&&R1.InProcessByUser&&!R1.DraftIsProcessedByMe);return S1&&!(P1&&!e.getProperty(P1,Q1));});}function c1(e){var i=e.getModel()&&e.getModel().getMetaModel();var j=i&&i.getODataEntitySet(e.getEntitySet());var k=j&&j["Org.OData.Capabilities.V1.DeleteRestrictions"];return k;}function d1(e,i,j,k){var P1=h1(k);var Q1=u.getView().getModel("_templPriv");var R1=Q1.getProperty("/generic/listCommons/breakoutActionsEnabled");if(P1){var S1=u.byId("template::IconTabBar");var T1="";if(S1){T1=S1.getSelectedKey();}e1(R1,P1,e,i,j,T1,k);}Q1.setProperty("/generic/listCommons/breakoutActionsEnabled",R1);}function e1(e,i,j,k,P1,Q1,R1){var S1;for(var T1 in i){S1=true;var U1=i[T1].id+((Q1&&!i[T1].determining)?"-"+Q1:"");if(R1&&R1.getId().indexOf("AnalyticalListPage")>-1){S1=!!e[U1].enabled;}if(i[T1].requiresSelection){if(k.length>0){if(R1&&h(R1)){if(i[T1].filter==="chart"){S1=true;}}else if(R1&&g(R1)){if(i[T1].filter!=="chart"){S1=true;}}if(i[T1].applicablePath!==undefined&&i[T1].applicablePath!==""){S1=false;for(var V1=0;V1<k.length;V1++){var W1="";var X1=i[T1].applicablePath.split("/");if(X1.length>1){for(var Y1=0;Y1<X1.length-1;Y1++){W1+="/"+X1[Y1];}}var Z1=P1.getObject(k[V1].getPath()+W1);var $1=X1[X1.length-1];if(Z1[$1]===true){S1=true;break;}}}}else if(h(R1)){if((R1.getId().indexOf("AnalyticalListPage")>-1?i[T1].filter==="chart":true)){if(R1.getDrillStackFilters().length>0){S1=true;}else{S1=false;}}}else{if(i[T1].filter!=="chart"){S1=false;}}}e[U1]={enabled:S1};}}function f1(e){var i=[];var j=h1(e);for(var k in j){i.push(j[k].id);}return i;}function g1(){var e=[];var i=h1();for(var j in i){if(i[j].determining){e.push(j);}}return e;}function h1(e){var i=u.getOwnerComponent();var j=i.getAppComponent().getManifestEntry("sap.ui5");var k=j.extends&&j.extends.extensions&&j.extends.extensions["sap.ui.controllerExtensions"];k=k&&k[i.getTemplateName()];k=k&&k["sap.ui.generic.app"];var P1=i.getEntitySet();var Q1=X(e).sectionId;if(!Q1){return k&&k[P1]&&k[P1]["Actions"];}else{var R1=k&&k[P1]&&k[P1]["Sections"];return R1&&R1[Q1]&&R1[Q1].Actions;}}function i1(e){var i=e;while(i){if(i instanceof R||l(i)||g(i)||h(i)){return i;}i=i.getParent&&i.getParent();}return null;}function j1(e){if(g(e)){e=e.getTable();}if(l(e)){return e.getBindingInfo("rows");}else if(e instanceof R){return e.getBindingInfo("items");}return null;}function k1(e){var i=j1(e);if(i&&i.binding){i.binding.refresh();}else if(e&&e.rebindTable){e.rebindTable();}}function l1(e){var i=u.getOwnerComponent();var j=i.getModel();var k,P1;var Q1=!S.oApplication.checkEtags();if(Q1){P1=j1(e);if(P1){k=P1.path;var R1=e.getEntitySet();var S1=j.getMetaModel();var T1=S1.getODataEntitySet(R1);if(u.getMetadata().getName()==='sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage'&&m1(j,T1)){j.invalidateEntityType(T1.entityType);}else{j.invalidate(n1.bind(null,k));}var U1=i.getId();var V1=Object.create(null);V1[U1]=true;S.oApplication.refreshAllComponents(V1);}}}function m1(e,i){var j=new o.Model(o.Model.ReferenceByModel(e));var k=j.findQueryResultByName(i.name);var P1=k&&k.getParameterization();return!!P1;}function n1(e,k,i){var j=e[0]==="/"?e.substr(1):e;if(k.split("(")[0]===j){return true;}else{return false;}}function o1(e,i){var j=e.getPath();var k=u.getOwnerComponent();var P1=k.getComponentContainer().getElementBinding();var Q1=P1?P1.getPath():"";var R1=null;if(j.indexOf(Q1)!==0){R1=j1(i).path;}var S1=!S.oApplication.isNewHistoryEntryRequired(e,R1);var T1;if(v.isDraftEnabled()){T1=S.oDraftController.isActiveEntity(e)?1:6;}else{T1=k.getModel("ui").getProperty("/editable")?6:1;}var U1=v.getViewLevel();if(U1===0){var V1=S.oApplication.getForwardNavigationProperty(U1);}if(V1){var W1=new Promise(function(Y1){e.getModel().createBindingContext(V1,e,null,function(Z1){if(Z1){S.oNavigationController.navigateToContext(Z1,R1,S1,T1);Y1();}else{v.navigateToDataLoadedFailedPage();Y1();}});});var X1=S.oApplication.getBusyHelper();X1.setBusy(W1);}else{S.oNavigationController.navigateToContext(e,R1,S1,T1);}}function p1(e,i){if(e instanceof a){S.oNavigationController.navigateToContext(e,i&&i.navigationProperty,i&&i.replaceInHistory);return;}var j=i&&i.routeName;if(j){v.navigateRoute(j,e,null,i&&i.replaceInHistory);return;}c.warning("navigateToContext called without context or route");}function q1(e){if(e instanceof b){if(e.getErrorCode()==="NavigationHandler.isIntentSupported.notSupported"){M.show(T("ST_NAV_ERROR_NOT_AUTHORIZED_DESC"),{title:T("ST_GENERIC_ERROR_TITLE")});}else{M.show(e.getErrorCode(),{title:T("ST_GENERIC_ERROR_TITLE")});}}}function r1(e,i){G1(function(){w=M1();var j={semanticObject:e.semanticObject,action:e.action};var k=w.mixAttributesAndSelectionVariant(e.parameters);u.adaptNavigationParameterExtension(k,j);w.navigate(e.semanticObject,e.action,k.toJSONString(),null,q1);},jQuery.noop,i,"LeavePage");}function s1(e){var P1=[],Q1,R1,S1;var T1=u.getOwnerComponent();var U1=T1.getModel().getMetaModel();if(!e){return{};}var V1=T1.getAppComponent().getConfig().pages[0];if(!V1){return{};}var W1=function(i){S1=U1.getODataEntitySet(i.entitySet).entityType;R1=U1.getODataEntityType(S1);Q1={};Q1={entitySet:i.entitySet,aKeys:U1.getODataEntityType(S1).key.propertyRef,navigationProperty:i.navigationProperty};for(var j=0,Y1=Q1.aKeys.length;j<Y1;j++){var k=0,Z1=R1.property.length;for(k;k<Z1;k++){if(Q1.aKeys[j].name===R1.property[k].name){Q1.aKeys[j].type=R1.property[k].type;break;}}}};var X1=function(e,V1){if(!V1.pages){return P1;}for(var i=0,j=V1.pages.length;i<j;i++){if(!V1.pages[i]){break;}if(e===V1.pages[i].entitySet){W1(V1.pages[i]);P1.splice(0,0,Q1);break;}P1=X1(e,V1.pages[i]);if(P1.length>0){W1(V1.pages[i]);P1.splice(0,0,Q1);}}return P1;};return X1(e,V1);}function t1(k,e){var P1,Q1,i,R1;for(i=0,R1=k.length;i<R1;i++){if(k[i].navigationProperty){Q1+="/"+k[i].navigationProperty;}else{Q1="/"+k[i].entitySet;}for(var j=0,S1=k[i].aKeys.length;j<S1;j++){if(j===0){Q1+="(";P1="";}else{P1=",";}switch(k[i].aKeys[j].type){case"Edm.Guid":if(e.DraftAdministrativeData&&e.DraftAdministrativeData.DraftIsCreatedByMe){Q1+=P1+k[i].aKeys[j].name+"="+"guid'"+e.DraftAdministrativeData[k[i].aKeys[j].name]+"'";}else{Q1+=P1+k[i].aKeys[j].name+"="+"guid'"+e[k[i].aKeys[j].name]+"'";}break;case"Edm.Boolean":if(e.DraftAdministrativeData&&e.DraftAdministrativeData.DraftIsCreatedByMe){Q1+=P1+k[i].aKeys[j].name+"="+false;}else{Q1+=P1+k[i].aKeys[j].name+"="+e[k[i].aKeys[j].name];}break;default:if(typeof e[k[i].aKeys[j].name]==="string"){Q1+=P1+k[i].aKeys[j].name+"="+"'"+e[k[i].aKeys[j].name]+"'";}else{Q1+=P1+k[i].aKeys[j].name+"="+e[k[i].aKeys[j].name];}break;}if(j===(S1-1)){Q1+=")";}}}return Q1;}function u1(e,k,u){var P1,Q1,R1,S1,T1,U1,V1;var W1={semanticObject:"",action:""};w=M1();P1=w.mixAttributesAndSelectionVariant({},k);for(S1 in e.semanticAttributesOfSemanticObjects){for(R1 in e.semanticAttributesOfSemanticObjects[S1]){if(!P1.getSelectOption(R1)){P1.addParameter(R1,"");}}T1=P1.getPropertyNames();W1.semanticObject=S1;u.adaptNavigationParameterExtension(P1,W1);U1=P1.getSelectOptionsPropertyNames();V1=P1.getParameterNames();for(var i=0,X1=T1.length;i<X1;i++){if(U1.indexOf(T1[i])<0&&V1.indexOf(T1[i])<0){delete e.semanticAttributesOfSemanticObjects[S1][T1[i]];P1.removeSelectOption(T1[i]);}}if(S1===e.semanticObject){var Y1=e.semanticAttributesOfSemanticObjects[""];for(var j=0,X1=V1.length;j<X1;j++){P1.removeParameter(V1[j]);if(!(V1[j]in Y1)){var Z1=e.semanticAttributesOfSemanticObjects[e.semanticObject][V1[j]];Z1=(typeof Z1==="undefined"||Z1===null)?"":String(Z1);P1.addParameter(V1[j],Z1);}}P1=w.mixAttributesAndSelectionVariant(e.semanticAttributesOfSemanticObjects[S1],P1.toJSONString());Q1=P1.toJSONString();}}delete e.semanticAttributes;w.processBeforeSmartLinkPopoverOpens(e,Q1);}function v1(e,j){var k=function(T1){for(var i=0;i<T1.length;i++){j(T1[i].name);}};var P1=u.getView().getModel().getMetaModel();var Q1=P1.getODataEntitySet(e,false);var R1=P1.getODataEntityType(Q1.entityType,false);k(R1.key.propertyRef);var S1=S.oDraftController.getDraftContext();if(S1.isDraftEnabled(e)){k(S1.getSemanticKey(e));j("IsActiveEntity");j("HasDraftEntity");j("HasActiveEntity");}}function w1(e,i){if(!v.isDraftEnabled()||!e){return;}var j=e.getControlByKey("EditState");var k=j&&j.getSelectedKey()||"";switch(k){case"1":i.filters.push(new F("IsActiveEntity","EQ",true));i.filters.push(new F("HasDraftEntity","EQ",false));break;case"2":i.filters.push(new F("IsActiveEntity","EQ",false));break;case"3":i.filters.push(new F("IsActiveEntity","EQ",true));i.filters.push(new F("SiblingEntity/IsActiveEntity","EQ",null));i.filters.push(new F("DraftAdministrativeData/InProcessByUser","NE",""));break;case"4":i.filters.push(new F("IsActiveEntity","EQ",true));i.filters.push(new F("SiblingEntity/IsActiveEntity","EQ",null));i.filters.push(new F("DraftAdministrativeData/InProcessByUser","EQ",""));break;default:var P1=new F({filters:[new F("IsActiveEntity","EQ",false),new F("SiblingEntity/IsActiveEntity","EQ",null)],and:false});if(i.filters[0]&&i.filters[0].aFilters){var Q1=i.filters[0];i.filters[0]=new F([Q1,P1],true);}else{i.filters.push(P1);}break;}}function x1(e,i){if(i){e.filters.push(new F("IsActiveEntity","EQ",true));}else{var j=new F({filters:[new F("IsActiveEntity","EQ",false),new F("SiblingEntity/IsActiveEntity","EQ",null)],and:false});if(e.filters[0]&&e.filters[0].aFilters){var k=e.filters[0];e.filters[0]=new F([k,j],true);}else{e.filters.push(j);}}}function y1(i,j,k){if(j&&i&&i.getAnalyticBindingPath&&i.getConsiderAnalyticalParameters()){try{var P1=i.getAnalyticBindingPath();if(P1){j(P1);}}catch(e){c.warning("Mandatory parameters have no values","",k);}}}function z1(e,j,k){for(var i=0;i<j.length;i++){var P1=j[i];var Q1=P1.lastIndexOf("/");var R1;if(Q1<0){if(S.oApplication.getNavigationProperty(e,P1)){R1=P1;}else{continue;}}else{R1=P1.substring(0,Q1);}if(k.indexOf(R1)===-1){k.push(R1);}}}function A1(e,i,j){var k=e.getParameter("bindingParams"),P1=e.getSource().getId();k.parameters=k.parameters||{};var Q1=v.getTemplatePrivateModel();var R1=Q1.getProperty("/listReport/vDraftState");var S1=Q1.getProperty("/listReport/activeObjectEnabled");var T1=function($1,_1,P1){if(i&&i[$1]){var a2=true;var b2=function(){var c2=arguments[0];if(!(c2 instanceof C)){throw new Error("Please provide a valid ControllerExtension in order to execute extension "+$1);}if(!a2){throw new Error("Extension "+$1+" must be executed synchronously");}var d2=Array.prototype.slice.call(arguments,1);_1.apply(null,d2);};i[$1](b2,P1);a2=false;}};var U1=function($1){if(!P1||u.byId(P1)===e.getSource()){k.filters.push($1);}};if((u.getMetadata().getName()!=='sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage')||(u.getMetadata().getName()!=='sap.suite.ui.generic.template.ObjectPage.view.Details')){if(R1=="0"&&v.isDraftEnabled()){x1(k,S1);}else{w1(j,k);}}T1("addExtensionFilters",U1,P1);if(u.getMetadata().getName()!=='sap.suite.ui.generic.template.ObjectPage.view.Details'){y1(j,i.setBindingPath,i.isAnalyticalListPage?"AnalyticalListPage":"ListReport");}var V1=e.getSource();var W1=V1.getEntitySet();var X1=k.parameters.select&&k.parameters.select.split(",")||[];var Y1=k.parameters.expand&&k.parameters.expand.split(",")||[];var Z1=function($1,P1){if($1&&(!P1||u.byId(P1)===e.getSource())){var _1=$1.split(',');_1.forEach(function(a2){if(a2&&jQuery.inArray(a2,X1)===-1){X1.push(a2);}});}};if(!i.isAnalyticalListPage){v1(W1,Z1);}T1("ensureExtensionFields",Z1,P1);(i.addNecessaryFields||jQuery.noop)(X1,Z1,W1);z1(W1,X1,Y1);if(Y1.length>0){k.parameters.expand=Y1.join(",");}if(X1.length>0){k.parameters.select=X1.join(",");}}function B1(e,i,j){if(!e){return T("DRAFT_OBJECT");}else if(i){return T(j?"LOCKED_OBJECT":"UNSAVED_CHANGES");}else{return"";}}function C1(){var e=K("sap.suite.ui.generic.template.fragments.DraftAdminDataPopover",{formatText:function(){var i=Array.prototype.slice.call(arguments,1);var k=arguments[0];if(!k){return"";}if(i.length>0&&(i[0]===null||i[0]===undefined||i[0]==="")){if(i.length>3&&(i[3]===null||i[3]===undefined||i[3]==="")){return(i.length>2&&(i[1]===null||i[1]===undefined||i[1]===""))?"":i[2];}else{return T(k,i[3]);}}else{return T(k,i[0]);}},closeDraftAdminPopover:function(){e.close();},formatDraftLockText:B1},"admin");return e;}function D1(e){var i={};if(e){i.discardPromise=e;}var j=u.getView();var k=j.getModel();if(k.hasPendingChanges()){j.setBindingContext(null);k.resetChanges();j.setBindingContext();}v.fire(u,"AfterCancel",{});}function E1(e,i,j,k,P1){var Q1=S.oApplication.getBusyHelper();if(!P1&&Q1.isBusy()){return;}if(!v.isDraftEnabled()){var R1=false;if(j&&j.aUnsavedDataCheckFunctions){R1=j.aUnsavedDataCheckFunctions.some(function(V1){return V1();});}var S1=u.getView();var T1=S1.getModel();if(R1||T1.hasPendingChanges()){var U1;J1(function(){D1();U1=e();},function(){U1=i();},k,false);return U1;}}return e();}function F1(e,i,j,k){var P1=false;if(j&&j.aUnsavedDataCheckFunctions){P1=j.aUnsavedDataCheckFunctions.some(function(R1){return R1();});}if(P1||u.getView().getModel().hasPendingChanges()){var Q1;J1(function(){u.getView().getModel().resetChanges();v.fire(u,"AfterCancel",{});Q1=e();},function(){Q1=i();},k,true);return Q1;}return e();}function G1(e,i,j,k,P1){if(P1){return E1(e,i,j,k,true);}S.oApplication.performAfterSideEffectExecution(E1.bind(null,e,i,j,k,false));}var H1;var I1;function J1(e,i,j,k){var P1;H1=e;I1=i;var Q1=k?"sap.suite.ui.generic.template.fragments.DataLossTechnicalError":"sap.suite.ui.generic.template.fragments.DataLoss";var R1=K(Q1,{onDataLossOK:function(){R1.close();H1();},onDataLossCancel:function(){R1.close();I1();}},"dataLoss");j=j||"LeavePage";P1=R1.getModel("dataLoss");P1.setProperty("/mode",j);R1.open();}function K1(e,i,j,k,P1,Q1){if(i.busy.check&&k.isBusy()){Q1();return;}var R1=i.busy.set?function(){k.setBusy(Promise.resolve(),false,{actionLabel:i.sActionLabel});return e();}:e;var S1=i.mConsiderObjectsAsDeleted?function(U1){S.oApplication.prepareDeletion(i.mConsiderObjectsAsDeleted);return R1();}:R1;var T1=(i.dataloss.popup?G1(S1,Q1,j,(i.dataloss.navigation?"LeavePage":"Proceed"),true):S1());if(T1 instanceof Promise){T1.then(P1,Q1);}else{P1();}}function L1(e,i,j){i=jQuery.extend(true,{busy:{set:true,check:true},dataloss:{popup:true,navigation:false}},i);var k=S.oApplication.getBusyHelper();var P1=new Promise(function(Q1,R1){S.oApplication.performAfterSideEffectExecution(K1.bind(null,e,i,j,k,Q1,R1));});if(i.busy.set){k.setBusy(P1,false,{actionLabel:i.sActionLabel});}return P1;}function M1(){w=w||new N(u);return w;}function N1(e){var j;var k=v.getTemplatePrivateModel();var P1=u.getOwnerComponent();var Q1,R1,S1,T1,U1,V1=[],W1=[],i,X1,Y1,Z1,$1,_1,a2;var b2,c2;Q1=P1.getAppComponent();R1=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService&&sap.ushell.Container.getService("CrossApplicationNavigation");S1=k.getProperty("/generic/supportedIntents/");if(h(e)){j=e.getToolbar();}else if(g(e)){j=e.getCustomToolbar();}T1=j.getContent();U1=T1.length;for(i=0;i<U1;i++){X1=X(T1[i]);if(X1.hasOwnProperty("SemanticObject")&&X1.hasOwnProperty("Action")){Y1=X1.SemanticObject;Z1=X1.Action;$1={semanticObject:Y1,action:Z1,ui5Component:Q1};V1.push([$1]);_1=Object.assign({},$1);_1.bLinkIsSupported=false;W1.push(_1);}}if(V1.length>0&&R1){a2=R1.getLinks(V1);a2.done(function(d2){S1=k.getProperty("/generic/supportedIntents/");b2=d2.length;for(i=0;i<b2;i++){if(d2[i][0].length>0){W1[i].bLinkIsSupported=true;}Y1=W1[i].semanticObject;Z1=W1[i].action;c2=k.getProperty("/generic/supportedIntents/"+Y1);if(!c2){S1[Y1]={};S1[Y1][Z1]={"visible":W1[i].bLinkIsSupported};}else if(!c2[Z1]){c2[Z1]={"visible":W1[i].bLinkIsSupported};}else{c2[Z1]["visible"]=W1[i].bLinkIsSupported;}}k.updateBindings();});}}function O1(e,i){var j=i&&u.byId(i);var k=(i&&!j)?Promise.reject():new Promise(function(P1,Q1){S.oApplication.performAfterSideEffectExecution(function(){var R1=S.oApplication.getBusyHelper();if(R1.isBusy()){Q1();return;}if(j&&(!j.getVisible()||(j.getEnabled&&!j.getEnabled()))){Q1();return;}var k=j?e(j):e();if(k instanceof Promise){k.then(P1,Q1);R1.setBusy(k);}else{P1(k);}});});k.catch(jQuery.noop);return k;}var M1=t.testable(M1,"getNavigationHandler");var d1=t.testable(d1,"fillEnabledMapForBreakoutActions");var f1=t.testable(f1,"getBreakoutActionIds");var i1=t.testable(i1,"getOwnerControl");var W=t.testable(W,"getSelectedContexts");var G=t.testable(G,"fnGetToolbarCutomData");return{isSmartTable:g,isSmartChart:h,isUiTable:l,isAnalyticalTable:m,isTreeTable:n,isMTable:p,getPositionableControlId:J,getCurrentEntitySetName:q,getMetaModelEntityType:y,getText:T,getContextText:U,getNavigationHandler:M1,getNavigationKeyProperties:s1,mergeNavigationKeyPropertiesWithValues:t1,executeGlobalSideEffect:function(){if(v.isDraftEnabled()){var e=u.getView();e.attachBrowserEvent("keydown",function(i){var j=(i.target.type==="search")?true:false;var k=(i.target.type==="textarea")?true:false;var P1=i.target.id.indexOf("rowAction")>-1?true:false;var Q1=i.target.id.indexOf("ColumnListItem")>-1?true:false;if(i.keyCode===13&&i.ctrlKey!==true&&e.getModel("ui").getProperty("/editable")&&!j&&!k&&!P1&&!Q1){var R1=u.getOwnerComponent().getAppComponent().getConfig();var S1=R1.settings&&R1.settings.forceGlobalRefresh;var T1;S.oApplication.addSideEffectPromise(new Promise(function(U1){T1=U1;}));setTimeout(function(){var U1=S.oApplicationController.executeSideEffects(e.getBindingContext(),null,null,S1);U1.then(function(){T1();setTimeout(function(){document.getElementById(i.target.id).focus();});});});}});}},setEnabledToolbarButtons:Y,setEnabledFooterButtons:$,fillEnabledMapForBreakoutActions:d1,getBreakoutActions:h1,getSelectedContexts:W,getSelectionPoints:V,getDeleteRestrictions:c1,setPrivateModelControlProperty:_,navigateFromListItem:o1,navigateToContext:p1,navigateExternal:r1,semanticObjectLinkNavigation:u1,getCustomData:function(e){var j=e.getSource().getCustomData();var k={};for(var i=0;i<j.length;i++){k[j[i].getKey()]=j[i].getValue();}return k;},onBeforeRebindTableOrChart:A1,formatDraftLockText:B1,resetChangesAndFireCancelEvent:D1,showDraftPopover:function(e,i){var j=C1();var k=j.getModel("admin");k.setProperty("/IsActiveEntity",e.getProperty("IsActiveEntity"));k.setProperty("/HasDraftEntity",e.getProperty("HasDraftEntity"));j.bindElement({path:e.getPath()+"/DraftAdministrativeData"});if(j.getBindingContext()){j.openBy(i);}else{j.getObjectBinding().attachDataReceived(function(){j.openBy(i);});}},getContentDensityClass:function(){return S.oApplication.getContentDensityClass();},attachControlToView:D,getDialogFragment:K,processDataLossConfirmationIfNonDraft:G1,processDataLossTechnicalErrorConfirmation:F1,securedExecution:L1,getOwnerControl:i1,getTableBindingInfo:j1,refreshSmartTable:k1,refreshModel:l1,getElementCustomData:X,triggerAction:function(e,i,j,k,P1){G1(function(){S.oCRUDManager.callAction({functionImportPath:j.Action,contexts:e,sourceControl:k,label:j.Label,operationGrouping:""}).then(function(Q1){if(Q1&&Q1.length>0){var R1=Q1[0];if(R1.response&&R1.response.context&&(!R1.actionContext||R1.actionContext&&R1.response.context.getPath()!==R1.actionContext.getPath())){S.oApplication.getBusyHelper().getUnbusy().then(S.oViewDependencyHelper.setMeToDirty.bind(null,u.getOwnerComponent(),i));}}});},jQuery.noop,P1,"Proceed");},checkToolbarIntentsSupported:N1,executeIfControlReady:O1,getControlInformation:z,executeForAllInformationObjects:A,focusControl:r};}return B.extend("sap.suite.ui.generic.template.lib.CommonUtils",{constructor:function(e,S,i){Object.assign(this,s(e,S,i));}});});
