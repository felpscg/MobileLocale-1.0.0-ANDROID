sap.ui.define(["sap/ui/base/Object","sap/ui/Device"],function(B,D){"use strict";var P="/listReport/multipleViews";var a=P+"/selectedKey";var b=P+"/msgVisibility";var c=P+"/finalMessage";function g(q,s,C,t,S,I,d){var e;var f,u=[];var T=t.oComponentUtils.getTemplatePrivateModel();function o(i){var j=i.getParameter("itemContexts")&&i.getParameter("itemContexts")[0];t.oCommonEventHandlers.onListNavigate(i,s,undefined,j);}function h(i){var j,Q;j=i.getSource();Q=j.getParent();s.updateControlOnSelectionChange(Q);}function r(i){var j;j=i.getSource();j.getChartAsync().then(function(Q){Q.attachSelectData(h);Q.attachDeselectData(h);});}function k(i){var j,Q,V={};for(j in I){Q=I[j].implementingControl;V[Q.getId()]=Q.getCurrentVariantId()||"";}return{selectedTab:i,tableVariantIds:V};}function l(i){var j,Q,V;if(i){if(i.tableVariantIds){for(j in I){Q=I[j].implementingControl;V=i.tableVariantIds[Q.getId()];if(V){Q.setCurrentVariantId(V);}}}return i.selectedTab;}}function m(i,j,Q){for(var V in I){var W=I[V].implementingControl;if((j||Q)&&W.getTable){W.setCurrentVariantId(j||Q);}else if((i||Q)&&W.getChart){W.setCurrentVariantId(i||Q);}}}function n(){return e;}function p(i){var j=t.oCommonUtils.getMetaModelEntityType(i);return j.property;}function v(i){s.oSmartTable=I[i].implementingControl;}function w(){var i=s.oSmartTable;var T=t.oComponentUtils.getTemplatePrivateModel();var j=G();var Q=JSON.parse(j.getValue());if(j){i.removeCustomData(j);}i.addCustomData(new sap.ui.core.CustomData({"key":"activeButtonTableState","value":!Q}));T.setProperty("/listReport/activeObjectEnabled",!Q);}function G(){var i=s.oSmartTable;var j;var Q=i.getCustomData();for(var V=0;V<Q.length;V++){if(Q[V].getKey()&&Q[V].getKey()==="activeButtonTableState"){j=Q[V];break;}}return j;}function R(){var i=s.oSmartTable;var T=t.oComponentUtils.getTemplatePrivateModel();var j=T.getProperty("/listReport/activeObjectEnabled");var Q=G();if(Q){i.removeCustomData(Q);}i.addCustomData(new sap.ui.core.CustomData({"key":"activeButtonTableState","value":j}));}function F(i,j){var Q,V,W=[];var X=I[T.getProperty(a)];if(X&&X.entitySet===j.getEntitySet()&&(X.implementingControl.getMetadata().getElementName()===j.getMetadata().getElementName())){for(var Y in i){Q=J(i[Y],j);V=Q["sap:label"]?Q["sap:label"]:Q.name;if(!W.includes(V)){W.push(V);}}f=z(j);L(W,f);}N(W);}function x(i,j){var Q;Q=M(i);if(Q){i.removeCustomData(Q);}i.addCustomData(new sap.ui.core.CustomData({"key":"multiTabMessageInfo","value":j}));}function y(i){var j,Q=[];for(j in I){if(I[j].implementingControl!==i){Q.push(I[j].properties);}}return Q;}function z(i){var j;var Q=T.getProperty(a);var V=C.getOwnerComponent().getAppComponent().getConfig();var W=V&&V.pages[0]&&V.pages[0].component&&V.pages[0].component.settings;for(var X in W.quickVariantSelectionX.variants){if(W.quickVariantSelectionX.variants[X].key===Q){j=W.quickVariantSelectionX.variants[X];break;}}var Y=t.oCommonUtils.getMetaModelEntityType(i);var Z=j?Y[j.annotationPath]:null;if(Z&&Z.Text){if(Z.Text.String.indexOf("i18n")!==-1){var $=Z.Text.String;$=$.substring(1,$.length-1).split(">").pop();return t.oCommonUtils.getText($);}else{return(Z.Text.String);}}}function A(i){if(i&&i.length>0){T.setProperty(b,true);}else{T.setProperty(b,false);}}function E(){var i=s.oSmartTable;var j=M(i);if(j){var Q={"filters":j.getValue().filters,"selectedKey":j.getValue().selectedKey,"isClosed":true};x(i,Q);A();}}function H(u){var i=false;var j=s.oSmartTable;var Q=M(j);if(Q&&Q.getValue().isClosed){if(Q.getValue().filters.length===u.length){if(JSON.stringify(Q.getValue().filters)===JSON.stringify(u)){i=true;}}}Q={"filters":u,"selectedKey":f};if(i){A();Q.isClosed=true;}else{A(u);Q.isClosed=false;}x(j,Q);}function J(i,j){var Q;var V=y(j);for(var W in V){var Q=K(V[W],i);if(Q){break;}}return Q;}function K(i,j){return i.filter(function(Q){return Q.name===j;})[0];}function L(i,f){var j="";if(i&&i.length>0){if((D.system.tablet||D.system.phone)&&!D.system.desktop){if(i.length>1){j=t.oCommonUtils.getText("MESSAGE_MULTIPLE_VALUES_S_FORM",[i.join(", "),f]);}else{j=t.oCommonUtils.getText("MESSAGE_SINGLE_VALUE_S_FORM",[i[0],f]);}}else{if(i.length>1){j=t.oCommonUtils.getText("MESSAGE_MULTIPLE_VALUES_L_FORM",[i.join(", "),f]);}else{j=t.oCommonUtils.getText("MESSAGE_SINGLE_VALUE_L_FORM",[i[0],f]);}}}T.setProperty(c,j);}function U(i){var j;j=M(i);if(j){var Q=j.getValue();L(Q.filters,Q.selectedKey);A(Q.filters);}else{A(u);}}function M(i){var j;var Q=I[T.getProperty(a)];if(Q.entitySet===i.getEntitySet()&&(Q.implementingControl.getMetadata().getElementName()===i.getMetadata().getElementName())){var V=i.getCustomData();for(var W=0;W<V.length;W++){if(V[W].getKey()&&V[W].getKey()==="multiTabMessageInfo"){j=V[W];break;}}}return j;}function N(i){u=i;}function O(){return u;}(function(){var j=C.byId("template::IconTabBar");if(!j){return;}var Q=C.getOwnerComponent().getEntitySet();var V=j.getItems();e=false;for(var i=0;i<V.length;i++){var W=V[i].getKey();if(i===0){S(W);}var X=C.byId("listReport-"+W);if(!s.oSmartTable){s.oSmartTable=X;}I[W]={id:X.getId(),entitySet:X.getEntitySet(),properties:p(X)};e=e||I[W].entitySet!==Q;d(W,X,X.getEntitySet());}s.oSmartFilterbar.attachSearch(function(Y){s.oMultipleViewsHandler.refreshOperation(3);});})();return{fnRegisterToChartEvents:r,onDetailsActionPress:o,getContentForIappState:k,getSelectedKeyAndRestoreFromIappState:l,onSelectedKeyChanged:v,getIsDifferentEntitySets:n,setActiveButtonState:w,restoreActiveButtonState:R,getActiveButtonStateCustomData:G,formatNotAppliedFilters:F,onMessageCloseActionPress:E,fnCheckForMessageDisplay:H,fnSetMessageVisibility:A,fnSetNotAppliedFilter:N,fnGetNotAppliedFilter:O,fnUpdateMessageForFilter:U,setControlVariant:m};}return B.extend("sap.suite.ui.generic.template.ListReport.controller.MultipleViewsMultipleTablesModeHelper",{constructor:function(q,s,C,t,S,i,d){Object.assign(this,g(q,s,C,t,S,i,d));}});});
