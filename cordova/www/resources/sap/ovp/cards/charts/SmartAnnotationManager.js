sap.ui.define(["sap/ui/thirdparty/jquery","sap/ovp/cards/charts/Utils","sap/ui/model/odata/CountMode","sap/ovp/cards/charts/VizAnnotationManager","sap/ovp/cards/AnnotationHelper","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/viz/ui5/api/env/Format","sap/viz/ui5/controls/VizTooltip","sap/ovp/app/resources","sap/base/Log","sap/base/util/each","sap/base/util/merge"],function(q,U,C,V,a,N,D,b,c,O,L,e,m){"use strict";var d={LABEL_KEY:"sap:label",LABEL_KEY_V4:"com.sap.vocabularies.Common.v1.Label",TEXT_KEY:"sap:text",TEXT_KEY_V4:"com.sap.vocabularies.Common.v1.Text",TYPE_KEY:"type",DISPLAY_FORMAT_KEY:"sap:display-format",SEMANTICS_KEY:"sap:semantics",UNIT_KEY:"sap:unit",UNIT_KEY_V4_ISOCurrency:"Org.OData.Measures.V1.ISOCurrency",UNIT_KEY_V4_Unit:"Org.OData.Measures.V1.Unit",CURRENCY_CODE:"currency-code",NAME_KEY:"name",NAME_CAP_KEY:"Name",EDM_TYPE:"type",EDM_INT32:"Edm.Int32",EDM_INT64:"Edm.Int64",SCATTER_CHARTTYPE:"com.sap.vocabularies.UI.v1.ChartType/Scatter",BUBBLE_CHARTTYPE:"com.sap.vocabularies.UI.v1.ChartType/Bubble",LINE_CHARTTYPE:"com.sap.vocabularies.UI.v1.ChartType/Line"};var f={CARD_WARNING:"OVP-AC: Analytic card: Warning: ",CARD_ERROR:"OVP-AC: Analytic card Error: ",DATA_ANNO_ERROR:"OVP-AC: Analytic card Error:",CARD_ANNO_ERROR:"OVP-AC: Analytic card: Error ",CHART_ANNO_ERROR:"OVP-AC: Analytic card: Error ",INVALID_CHART_ANNO:"OVP-AC: Analytic Cards: Invalid Chart Annotation.",ANALYTICAL_CONFIG_ERROR:"Analytic card configuration error",CACHING_ERROR:"no model defined while caching OdataMetaData",INVALID_MAXITEMS:"maxItems is Invalid. ",NO_DATASET:"OVP-AC: Analytic Cards: Could not obtain dataset.",SORTORDER_WARNING:"SortOrder is present in PresentationVariant, but it is empty or not well formed.",BOOLEAN_ERROR:"Boolean value is not present in PresentationVariant.",IS_MANDATORY:"is mandatory.",IS_MISSING:"is missing.",NOT_WELL_FORMED:"is not found or not well formed)",MISSING_CHARTTYPE:"Missing ChartType in ",CHART_ANNO:"Chart Annotation.",DATA_ANNO:"Data Annotation",CARD_ANNO:"card annotation.",CARD_CONFIG:"card configuration.",CARD_CONFIG_ERROR:"Could not obtain configuration for ",CARD_CONTAINER_ERROR:"Could not obtain card container. ",DATA_UNAVAIALABLE:"No data available.",CONFIG_LOAD_ERROR:"Failed to load config.json. Reason: ",INVALID_CHARTTYPE:"Invalid ChartType given for ",INVALID_CONFIG:"No valid configuration given for ",CONFIG_JSON:"in config.json",ENTER_INTEGER:"Please enter an Integer.",NO_CARD_MODEL:"Could not obtain Cards model.",ANNO_REF:"com.sap.vocabularies.UI.v1 annotation.",INVALID_REDUNDANT:"Invalid/redundant role configured for ",CHART_IS:"chart is/are ",CARD_CONFIG_JSON:"card from config.json",ALLOWED_ROLES:"Allowed role(s) for ",DIMENSIONS_MANDATORY:"DimensionAttributes are mandatory.",MEASURES_MANDATORY:"MeasureAttributes are mandatory.",CARD_LEAST:"card: Enter at least ",CARD_MOST:"card: Enter at most ",FEEDS:"feed(s).",MIN_FEEDS:"Minimum number of feeds required for ",FEEDS_OBTAINED:"card is not configured. Obtained ",FEEDS_REQUIRED:"feed(s), Required: ",INVALID_SEMANTIC_MEASURES:"More than one measure is being semantically coloured",INVALID_IMPROVEMENT_DIR:"No Improvement Direction Found",INVALID_CRITICALITY:"Invalid criticality values",INVALID_DIMMEAS:"Invalid number of Measures or Dimensions",INVALID_FORECAST:"Invalid/Redundant Datapoint or Forecast measure",ERROR_MISSING_AXISSCALES:"Minimum and Maximum values are mandatory for AxisScale MinMax to work"};function g(){var i={locale:function(){},format:function(v,j){var k="";if(j){k=j.split('/');}if(k.length>0){var x,M;if(k.length==3){x=Number(k[1]);M=Number(k[2]);if(isNaN(x)){x=-1;}if(isNaN(M)){M=0;}}else{x=2;M=0;}if(k[0]=="axisFormatter"||(k[0]=="ShortFloat")){var P;P=N.getFloatInstance({style:'short',minFractionDigits:x,maxFractionDigits:x});if(k[0]=="ShortFloat"){P=N.getFloatInstance({style:'short',minFractionDigits:x,maxFractionDigits:x});}if(x===-1){P=N.getFloatInstance({style:'short'});}return P.format(Number(v));}else if(k[0]==="tooltipNoScaleFormatter"){var Q=N.getFloatInstance({style:'short',currencyCode:false,shortRefNumber:M,showScale:false,minFractionDigits:x,maxFractionDigits:x});if(x===-1){Q=N.getCurrencyInstance({style:'short',currencyCode:false});}return Q.format(Number(v));}else if(k[0]=="CURR"){var R=N.getCurrencyInstance({style:'short',currencyCode:false,minFractionDigits:x,maxFractionDigits:x});if(x===-1){R=N.getCurrencyInstance({style:'short',currencyCode:false});}return R.format(Number(v));}else if(k[0].search("%")!==-1){var S=N.getPercentInstance({style:'short',minFractionDigits:x,maxFractionDigits:x});if(x===-1){S=N.getPercentInstance({style:'short',minFractionDigits:1,maxFractionDigits:1});}v=S.format(Number(v));return v;}}if(v.constructor===Date){var T=D.getDateTimeInstance({pattern:j});if(j==="YearMonthDay"){T=D.getDateInstance({style:"medium"});}v=T.format(new Date(v));}return v;}};b.numericFormatter(i);}function h(i,j,k,M,v,x){M=typeof M==="undefined"?false:M;var P=false;var Q;if(!i&&M){L.error(v+f.CARD_ERROR+k+f.IS_MANDATORY);return P;}if(!i){L.warning(v+f.CARD_WARNING+k+f.IS_MISSING);P=true;return P;}Q=j[i];if(!Q||typeof Q!=="object"){var R=M?L.error:L.warning;R(v+f.CARD_ERROR+"in "+k+". ("+i+" "+f.NOT_WELL_FORMED);return P;}if(x&&x=="sap.ovp.cards.charts.analytical.analyticalChart"&&k=="Chart Annotation"&&(!Q.ChartType||!Q.ChartType.EnumMember)){L.error(v+f.CARD_ERROR+f.MISSING_CHARTTYPE+f.CHART_ANNO);return P;}P=true;return P;}function l(i){var j=false;if(!i){return j;}var k;var v;var x;var M;var P;var Q;var R;var S="";var T;var W=i.getView();if(W){S="["+W.getId()+"] ";}if(!(T=i.getCardPropertiesModel())){L.error(S+f.CARD_ERROR+"in "+f.CARD_CONFIG+f.NO_CARD_MODEL);return j;}R=T.getProperty("/entityType");if(!R||q.isEmptyObject(R)){L.error(S+f.CARD_ERROR+"in "+f.CARD_ANNO);return j;}k=T.getProperty("/selectionAnnotationPath");v=T.getProperty("/chartAnnotationPath");M=T.getProperty("/presentationAnnotationPath");P=T.getProperty("/identificationAnnotationPath");Q=T.getProperty("/dataPointAnnotationPath");x=T.getProperty("/contentFragment");j=h(k,R,"Selection Variant",false,S);j=h(v,R,"Chart Annotation",true,S,x)&&j;j=h(M,R,"Presentation Variant",false,S)&&j;j=h(P,R,"Identification Annotation",true,S)&&j;j=h(Q,R,"Data Point",false,S)&&j;return j;}function n(i){return U.getConfig(i);}function o(j,k,v,x){var M=false;var P;var Q;var R;var S;var T;var W;if(!k.time||q.isEmptyObject(k.time)){return M;}if(!j){return M;}if(!j[0].Dimension||!(Q=j[0].Dimension.PropertyPath)){return M;}P=u(v,x);for(var i=0;i<j.length;i++){if(j[i]&&j[i].Dimension&&j[i].Dimension.PropertyPath){Q=j[i].Dimension.PropertyPath;}if(P&&P[Q]){R=P[Q][d.TYPE_KEY];S=P[Q][d.DISPLAY_FORMAT_KEY];T=P[Q][d.SEMANTICS_KEY];W=P[Q]["com.sap.vocabularies.Common.v1.IsCalendarYear"];}if(R&&S&&R.lastIndexOf("Edm.Date",0)===0&&S.toLowerCase()=="date"){M=true;return M;}if(R=="Edm.String"&&(W||T&&T.lastIndexOf("year",0)===0)){M=true;return M;}}return M;}function p(i,j,k){var v="";var x=n(j);var M,P;if(!x){return v;}v=x.default.type;M=i.getSetting("dataModel");P=i.getSetting('ovpCardProperties').getProperty("/entitySet");if(o(k,x,M,P)){v=x.time.type;}return v;}p.requiresIContext=true;function r(v){var i;if(v){if(v.String){i=v.String;}else if(v.Boolean||v.Bool){i=s(v);}else{i=t(v);}}return i;}function s(v,i){if(v&&v.Boolean){if(v.Boolean.toLowerCase()==="true"){return true;}else if(v.Boolean.toLowerCase()==="false"){return false;}}else if(v&&v.Bool){if(v.Bool.toLowerCase()==="true"){return true;}else if(v.Bool.toLowerCase()==="false"){return false;}}return i;}function t(v){var i;if(v){if(v.String){i=Number(v.String);}else if(v.Int){i=Number(v.Int);}else if(v.Decimal){i=Number(v.Decimal);}else if(v.Double){i=Number(v.Double);}else if(v.Single){i=Number(v.Single);}}return i;}function u(i,j){var k=U.cacheODataMetadata(i);if(!k){return undefined;}return k[j];}function w(v,M){v.attachSelectData(function(P){var Q=v.getModel('ovpCardProperties');var R=v.getModel();var S=Q.getProperty("/entitySet");var T=u(R,S);var W=[],X=[];var Y={},Z={};var $=v.getDataset().getDimensions();var _;for(var i=0;i<$.length;i++){W.push($[i].getIdentity());}var a1=q.map(v.getDataset()._getDataContexts(),function(x){return x.getObject();});if(P.getParameter("data")&&P.getParameter("data")[0]&&P.getParameter("data")[0].data){_=P.getParameter("data")[0].data._context_row_number;if(a1[_].$isOthers&&a1[_].$isOthers==true){var b1={$isOthers:true};var c1={getObject:function(){return b1;}};M.doNavigation(c1);}else{X=Object.keys(P.getParameter("data")[0].data);for(var j=0;j<W.length;j++){for(var k=0;k<X.length;k++){if(W[j]==X[k]){Y[W[j]]=a1[_][W[j]];}for(var d1 in a1[_]){if(T.hasOwnProperty(d1)){Z[d1]=a1[_][d1];}}}}var c1={getObject:function(){return Y;},getAllData:function(){return Z;}};M.doNavigation(c1);}}});}function y(i){if(i.EnumMember.endsWith("Bubble")){return true;}else{return false;}}function z(i){var j=false;if(!i||i.constructor!=Array||i.length<1||i[0].constructor!=Object||!i[0].Dimension||!i[0].Dimension.PropertyPath){L.error(f.CHART_ANNO_ERROR+"in "+f.CHART_ANNO+" "+f.DIMENSIONS_MANDATORY);return j;}j=true;return j;}function A(i){var j=false;if(!i||i.constructor!=Array||i.length<1||i[0].constructor!=Object||!i[0].Measure||!i[0].Measure.PropertyPath){L.error(f.CHART_ANNO_ERROR+"in "+f.CHART_ANNO+" "+f.MEASURES_MANDATORY);return j;}j=true;return j;}function B(i){return i.name;}function E(i){if(i&&i.indexOf("#")!=-1){var j=i.split("#");if(j.length>1){return j[1];}}return"";}function F(k,v,x){function M(R1,S1,T1){var U1=S1.split('.');var g1=U1.pop();var V1=U1.reduce(function(W1,X1){if(W1[X1]===undefined){W1[X1]={};}return W1[X1];},R1);if(T1){V1[g1]=T1;}return V1[g1];}var P,Q,R,S;var T,W,X,Y,Z,$,_;var a1;var b1;var c1;var d1=[],e1=[];var f1=k.getChart();T=f1.getChartType();W=n();for(var g1 in W){if((b1=W[g1].reference)&&W[b1]){var h1=q.extend(true,{},W[b1]);W[g1]=h1;}if(W[g1].default.type==T||(W[g1].time&&W[g1].time.type==T)){X=W[g1];break;}}if(!X){L.error(f.CARD_ERROR+"in "+f.CARD_CONFIG+f.CARD_CONFIG_ERROR+T+" "+f.CARD_CONFIG_JSON);return;}if(!(P=k.getModel('ovpCardProperties'))){L.error(f.CARD_ERROR+"in "+f.CARD_CONFIG+f.NO_CARD_MODEL);return;}var i1=k.getModel();var j1=P.getProperty("/entitySet");if(!i1||!j1){return;}Q=P.getProperty("/entityType");if(!Q){L.error(f.CARD_ANNO_ERROR+"in "+f.CARD_ANNO);return;}var k1=u(i1,j1);R=P.getProperty("/chartAnnotationPath");if(!R||!(S=Q[R])){L.error(f.CARD_ANNO_ERROR+"in "+f.CARD_ANNO);return;}if(!(Y=S.DimensionAttributes)||!Y.length){L.error(f.CHART_ANNO_ERROR+"in "+f.CHART_ANNO+" "+f.DIMENSIONS_MANDATORY);return;}var l1;if(!(Z=S.MeasureAttributes)||!Z.length){L.error(f.CHART_ANNO_ERROR+"in "+f.CHART_ANNO+" "+f.MEASURES_MANDATORY);return;}else{var m1=Z[0].DataPoint?Q[Z[0].DataPoint.AnnotationPath.substring(1)]:null;var n1=m1&&m1.ValueFormat&&m1.ValueFormat.NumberOfFractionalDigits&&m1.ValueFormat.NumberOfFractionalDigits.Int;l1=n1?n1:0;}_=Y.slice();$=Z.slice();var o1,p1;for(var i=0;i<_.length;i++){var q1=_[i];if(q1&&q1.Dimension&&q1.Dimension.PropertyPath){o1=q1.Dimension.PropertyPath;if(k1&&k1[o1]){if(k1[o1][d.LABEL_KEY_V4]){p1=k1[o1][d.LABEL_KEY_V4].String?k1[o1][d.LABEL_KEY_V4].String:k1[o1][d.LABEL_KEY_V4].Path;}else if(k1[o1][d.LABEL_KEY]){p1=k1[o1][d.LABEL_KEY];}else if(o1){p1=o1;}e1.push(p1);}}}for(var j=0;j<$.length;j++){var r1=$[j];if(r1&&r1.Measure&&r1.Measure.PropertyPath){o1=r1.Measure.PropertyPath;if(k1&&k1[o1]){if(k1[o1][d.LABEL_KEY_V4]){p1=k1[o1][d.LABEL_KEY_V4].String?k1[o1][d.LABEL_KEY_V4].String:k1[o1][d.LABEL_KEY_V4].Path;}else if(k1[o1][d.LABEL_KEY]){p1=k1[o1][d.LABEL_KEY];}else if(o1){p1=o1;}d1.push(p1);}}}a1=o(Y,X,i1,j1);if(a1){X=X.time;}else{X=X.default;}var s1=false;var t1=l1>0?"tooltipNoScaleFormatter/"+l1.toString()+"/":'tooltipNoScaleFormatter/-1/';var u1=new c({formatString:t1});u1.connect(f1.getVizUid());if(f1){var v1=f1.getVizProperties();var w1=true;if(X.properties&&X.properties.hasOwnProperty("hideLabel")&&!X.properties["hideLabel"]){w1=false;}var x1=false;if(T=='donut'){x1=true;}if(v1&&v1.plotArea&&v1.plotArea.dataLabel&&v1.plotArea.dataLabel.visible){v1.plotArea.dataLabel.visible=x1;}v1.title.visible=w1?false:true;c1={legend:{isScrollable:false},valueAxis:{title:{visible:w1?false:true},label:{formatString:v1.valueAxis.label.formatString+(l1?"/"+l1+"/":"")}},categoryAxis:{title:{visible:w1?false:true}},plotArea:{window:{start:'firstDataPoint',end:'lastDataPoint'},dataLabel:{visible:x1,type:'value'}},interaction:{selectability:{legendSelection:false,axisLabelSelection:false,mode:'EXCLUSIVE',plotLassoSelection:false,plotStdSelection:true},zoom:{enablement:'disabled'}}};var y1=P.getProperty("/colorPalette");var z1;if(S.ChartType.EnumMember===V.constants.COLUMNSTACKED_CHARTTYPE&&y1&&y1.length===4){e(Y,function(i,R1){if(R1&&R1.Role&&R1.Role.EnumMember=="com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Series"){z1=R1.Dimension&&R1.Dimension.PropertyPath;return;}});var A1;if(z1){var B1=k.getChart();if(z1&&!x.bSorterSetForCustomCharts){var C1=B1.getBinding("data");if(C1){C1.sort([new sap.ui.model.Sorter(z1,true)]);x.bSorterSetForCustomCharts=true;}}if(k1&&k1[z1]){if(k1[z1][d.LABEL_KEY_V4]){A1=k1[z1][d.LABEL_KEY_V4].String?k1[z1][d.LABEL_KEY_V4].String:k1[z1][d.LABEL_KEY_V4].Path;}else if(k1[z1][d.LABEL_KEY]){A1=k1[z1][d.LABEL_KEY];}else if(z1){A1=z1;}}var D1=y1.map(function(R1){return R1.color;});var E1=y1.map(function(R1){return R1.legendText;});var F1=E1[0]!=undefined?E1[0]:O.getText("OTHERS");var G1=E1[1]!=undefined?E1[1]:O.getText("BAD");var H1=E1[2]!=undefined?E1[2]:O.getText("CRITICAL");var I1=E1[3]!=undefined?E1[3]:O.getText("GOOD");c1.plotArea.dataPointStyle={rules:[{callback:function(x){if((x&&(x[A1]==="3"||x[A1]===3))||(x&&(x[z1]==="3"||x[z1]===3))){return true;}},properties:{color:D1[3]},"displayName":I1},{callback:function(x){if((x&&(x[A1]==="2"||x[A1]===2))||(x&&(x[z1]==="2"||x[z1]===2))){return true;}},properties:{color:D1[2]},"displayName":H1},{callback:function(x){if((x&&(x[A1]==="1"||x[A1]===1))||(x&&(x[z1]==="1"||x[z1]===1))){return true;}},properties:{color:D1[1]},"displayName":G1},{callback:function(x){if((x&&(x[A1]==="0"||x[A1]===0))||(x&&(x[z1]==="0"||x[z1]===0))){return true;}},properties:{color:D1[0]},"displayName":F1}]};}}if(S.ChartType.EnumMember===d.SCATTER_CHARTTYPE||S.ChartType.EnumMember===d.BUBBLE_CHARTTYPE||S.ChartType.EnumMember===d.LINE_CHARTTYPE){if(S&&S.AxisScaling&&S.AxisScaling.EnumMember){var J1=S.AxisScaling.EnumMember.substring(S.AxisScaling.EnumMember.lastIndexOf('/')+1,S.AxisScaling.EnumMember.length);switch(J1){case"AdjustToDataIncluding0":c1.plotArea.adjustScale=false;break;case"AdjustToData":c1.plotArea.adjustScale=true;break;case"MinMaxValues":var K1=[];if(S["MeasureAttributes"][0]&&S["MeasureAttributes"][0].DataPoint&&S["MeasureAttributes"][0].DataPoint.AnnotationPath){var L1=S["MeasureAttributes"][0].DataPoint.AnnotationPath;var M1=L1.substring(L1.lastIndexOf('@')+1,L1.length);if(Q&&Q[M1]){var N1=Q[M1];if(N1&&N1.MaximumValue&&N1.MaximumValue.Decimal&&N1.MinimumValue&&N1.MinimumValue.Decimal){K1.push({feed:"valueAxis",max:N1.MaximumValue.Decimal,min:N1.MinimumValue.Decimal});}else{L.error(f.ERROR_MISSING_AXISSCALES);}}}if(S.ChartType.EnumMember!==d.LINE_CHARTTYPE&&S["MeasureAttributes"][1]&&S["MeasureAttributes"][1].DataPoint&&S["MeasureAttributes"][1].DataPoint.AnnotationPath){var L1=S["MeasureAttributes"][1].DataPoint.AnnotationPath;var M1=L1.substring(L1.lastIndexOf('@')+1,L1.length);if(Q&&Q[M1]){var N1=Q[M1];if(N1&&N1.MaximumValue&&N1.MaximumValue.Decimal&&N1.MinimumValue&&N1.MinimumValue.Decimal){K1.push({feed:"valueAxis2",max:N1.MaximumValue.Decimal,min:N1.MinimumValue.Decimal});}else{L.error(f.ERROR_MISSING_AXISSCALES);}}}f1.setVizScales(K1);break;default:break;}}}var O1=P.getProperty('/ChartProperties');if(X.hasOwnProperty('vizProperties')){var P1=X.vizProperties;for(var i=0;i<P1.length;i++){if(O1&&P1[i].hasOwnProperty('path')){var Q1=M(O1,P1[i].path);if(undefined!==Q1){M(c1,P1[i].path,Q1);}}}}f1.setVizProperties(c1);}[X.dimensions,X.measures].forEach(function(R1,i){var S1=i?Z:Y;var T1=i?"measure(s)":"dimension(s)";if(R1.min&&S1.length<R1.min){L.error(f.CARD_ERROR+"in "+T+" "+f.CARD_LEAST+R1.min+" "+T1);s1=true;}if(R1.max&&S1.length>R1.max){L.error(f.CARD_ERROR+"in "+T+f.CARD_MOST+R1.max+" "+T1);s1=true;}});if(s1){return;}G(d1,e1,v);if(k){if(k._headerText){k._headerText.setTooltip(k.getHeader());k._headerText.addStyleClass("ovpChartTitle");}}}function G(j,k,v){var x="",M="",P="";if(v){x=v.getText();}if(j&&(j.length>1)){for(var i=0;i<j.length-1;i++){if(M!=""){M+=", ";}M+=j[i];}M=O.getText("MEAS_DIM_TITLE",[M,j[i]]);}else if(j){M=j[0];}if(k&&(k.length>1)){for(var i=0;i<k.length-1;i++){if(P!=""){P+=", ";}P+=k[i];}P=O.getText("MEAS_DIM_TITLE",[P,k[i]]);}else if(k){P=k[0];}if(v&&(x=="")){x=O.getText("NO_CHART_TITLE",[M,P]);v.setText(x);v.data("aria-label",x,true);}}function H(M,j){var k;e(j,function(i,v){if(v.name==M){if(v["com.sap.vocabularies.Common.v1.Label"]){k=v["com.sap.vocabularies.Common.v1.Label"].String?v["com.sap.vocabularies.Common.v1.Label"].String:v["com.sap.vocabularies.Common.v1.Label"].Path;}else if(v["sap:label"]){k=v["sap:label"];}return false;}});return k;}function I(M,P,v){var i=d.TYPE_KEY;if(!M||!M[P]||!M[P][i]){return v;}var j=["Edm.Int","Edmt.Int16","Edm.Int32","Edm.Int64","Edm.Decimal"];var k=M[P][i];if((j?Array.prototype.indexOf.call(j,k):-1)!==-1){return Number(v);}return v;}function J(S){var i=S.getModel('ovpCardProperties'),j=i.getProperty("/entityType"),k=i.getProperty("/presentationAnnotationPath"),v=j.hasOwnProperty(k)&&j[k],x=v&&v.MaxItems;if(x){return{itemsLength:+(x.Int32?x.Int32:x.Int),dataStep:+i.getProperty("/dataStep")};}}function K(S,j){S.attachDataReceived(function(k){var x=j.getView().byId("ovpCT1");var M=S._getVizFrame();var P=j.getView().byId("bubbleText");var Q=O.getText("BUBBLESIZE");if(M){if(P!=undefined){var R=M.getFeeds();e(R,function(i,v){if(R[i].getUid()=="bubbleWidth"){var T=j.getEntitySet()&&j.getEntitySet().name;var W=M.getModel();var X=u(W,T);var Y=R[i].getValues()&&R[i].getValues()[0]&&R[i].getValues()[0].getName();var Z=H(Y,X);P.setText(Q+" "+Z);}});}}if(!j.isVizPropSet){F(S,x,j);j.isVizPropSet=true;}});}return{getSapLabel:H,buildSmartAttributes:F,errorMessages:f,formatChartAxes:g,checkExists:h,validateCardConfiguration:l,getConfig:n,hasTimeSemantics:o,getChartType:p,getPrimitiveValue:r,getMetadata:u,getSelectedDataPoint:w,checkBubbleChart:y,dimensionAttrCheck:z,measureAttrCheck:A,getEntitySet:B,getAnnotationQualifier:E,formatByType:I,getMaxItems:J,attachDataReceived:K};},true);
